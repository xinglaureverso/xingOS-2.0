function abrirJanela(titulo) {
  const janela = document.createElement("div");
  janela.className = "janela";
  janela.innerHTML = `
    <div class="janela-topo">
      <span>${titulo}</span>
      <button onclick="this.closest('.janela').remove()">‚ùå</button>
    </div>
    <div class="janela-corpo">Conte√∫do de "${titulo}"</div>
  `;
  document.getElementById("janelas").appendChild(janela);

  // Posicionamento aleat√≥rio
  janela.style.top = Math.random() * 300 + "px";
  janela.style.left = Math.random() * 400 + "px";

  // Arrastar janela
  const topo = janela.querySelector(".janela-topo");
  topo.onmousedown = function (e) {
    const offsetX = e.clientX - janela.offsetLeft;
    const offsetY = e.clientY - janela.offsetTop;
    document.onmousemove = function (e) {
      janela.style.left = e.clientX - offsetX + "px";
      janela.style.top = e.clientY - offsetY + "px";
    };
    document.onmouseup = function () {
      document.onmousemove = null;
      document.onmouseup = null;
    };
  };
}

// ‚è∞ Rel√≥gio estilo XP
setInterval(() => {
  document.getElementById("hora-xp").textContent = new Date().toLocaleTimeString();
}, 1000);

// üñ±Ô∏è Menu de contexto XP
document.addEventListener("contextmenu", function (e) {
  e.preventDefault();
  const menu = document.getElementById("menu-contexto");
  menu.style.top = e.clientY + "px";
  menu.style.left = e.clientX + "px";
  menu.classList.remove("oculto");
});

// üñ±Ô∏è Ocultar menu ao clicar fora
document.addEventListener("mousedown", function (e) {
  const menu = document.getElementById("menu-contexto");
  if (!menu.contains(e.target)) {
    menu.classList.add("oculto");
  }
});
function toggleMenu() {
  const menu = document.getElementById("menu-iniciar");
  menu.classList.toggle("oculto");
}

// Oculta menu iniciar ao clicar fora
document.addEventListener("mousedown", function (e) {
  const menu = document.getElementById("menu-iniciar");
  const botao = document.getElementById("botao-iniciar");

  if (!menu.contains(e.target) && e.target !== botao) {
    menu.classList.add("oculto");
  }
});

// Rel√≥gio estilo XP
setInterval(() => {
  document.getElementById("hora-xp").textContent = new Date().toLocaleTimeString();
}, 1000);
function abrirJanela(titulo) {
  const janela = document.createElement("div");
  janela.className = "janela";
  
  let conteudo = `<div class="janela-corpo">Conte√∫do de "${titulo}"</div>`;
  
  if (titulo === "Internet Explorer") {
    conteudo = `
      <div class="janela-corpo">
        <h3 style="color:#003399;">üåê Internet Explorer XP</h3>
        <p>Bem-vindo √† WebXingOS!</p>
        <button onclick="instalarBonzi()" style="padding:6px 12px; background:#7b00b9; color:white; border:none; border-radius:6px;">üêí Instalar BonziBuddy</button>
      </div>
    `;
  }

  janela.innerHTML = `
    <div class="janela-topo">
      <span>${titulo}</span>
      <button onclick="this.closest('.janela').remove()">‚ùå</button>
    </div>
    ${conteudo}
  `;
  document.getElementById("janelas").appendChild(janela);

  // Posicionamento aleat√≥rio
  janela.style.top = Math.random() * 300 + "px";
  janela.style.left = Math.random() * 400 + "px";

  // Drag
  const topo = janela.querySelector(".janela-topo");
  topo.onmousedown = function (e) {
    const offsetX = e.clientX - janela.offsetLeft;
    const offsetY = e.clientY - janela.offsetTop;
    document.onmousemove = function (e) {
      janela.style.left = e.clientX - offsetX + "px";
      janela.style.top = e.clientY - offsetY + "px";
    };
    document.onmouseup = function () {
      document.onmousemove = null;
      document.onmouseup = null;
    };
  };
}
if (titulo === "BonziBuddy") {
  conteudo = `
    <div class="janela-corpo">
      <h3 style="color:#8000a0;">üêµ BonziBuddy XP</h3>
      <p>Ol√°! Eu sou o BonziBuddy! üòà</p>
      <p>Pronto para tornar sua experi√™ncia reversa... ainda mais ca√≥tica!</p>
      <button onclick="alert('BonziBuddy configurado!')">‚öôÔ∏è Configurar</button>
    </div>
  `;
}
function executarAntivirus() {
  gerarErro("Erro cr√≠tico: C√≥digo 0x0000001");
  setTimeout(() => gerarErro("Falha na prote√ß√£o reversa"), 1200);
  setTimeout(() => gerarErro("Sistema comprometido!"), 2500);
  setTimeout(() => abrirJanela("Jump Scare"), 4000);
}

function gerarErro(msg) {
  const erro = document.createElement("div");
  erro.className = "janela";
  erro.innerHTML = `
    <div class="janela-topo">
      <span>Erro do Sistema</span>
      <button onclick="this.closest('.janela').remove()">‚ùå</button>
    </div>
    <div class="janela-corpo">
      <p style="color:red; font-weight:bold;">‚ùå ${msg}</p>
    </div>
  `;
  document.getElementById("janelas").appendChild(erro);

  erro.style.top = Math.random() * 300 + "px";
  erro.style.left = Math.random() * 400 + "px";
}
if (titulo === "Jump Scare") {
  conteudo = `
    <div class="janela-corpo">
      <h3 style="color:darkred;">‚ö†Ô∏è ALERTA</h3>
      <video autoplay muted loop width="100%">
        <source src="jumpscare.mp4" type="video/mp4">
        Seu navegador n√£o suporta v√≠deo.
      </video>
    </div>
  `;
}
function abrirJogoSonic() {
  const janela = document.createElement("div");
  janela.className = "janela";
  janela.innerHTML = `
    <div class="janela-topo">
      <span>Sonic.exe</span>
      <button onclick="this.closest('.janela').remove()">‚ùå</button>
    </div>
    <div class="janela-corpo" id="fase-sonic">
      <h3 style="color:#0099ff;">Fase 1 - Green Hill</h3>
      <p>Sonic est√° correndo alegremente pelo campo...</p>
      <img src="fase1.gif" width="100%">
    </div>
  `;
  document.getElementById("janelas").appendChild(janela);

  janela.style.top = "100px";
  janela.style.left = "120px";

  // Ap√≥s alguns segundos, fase 2
  setTimeout(() => {
    const fase = document.getElementById("fase-sonic");
    fase.innerHTML = `
      <h3 style="color:red;">Fase 2 - Chaos Hill</h3>
      <p><strong>Sonic parou...</strong> H√° olhos brilhando e sangue no ch√£o.</p>
      <img src="fase2.gif" width="100%">
      <audio autoplay>
        <source src="sonic-scream.mp3" type="audio/mp3">
      </audio>
    `;
  }, 4000); // 4 segundos
}
function instalarWin7() {
  abrirJanela("Instalador do Windows 7");

  setTimeout(() => {
    abrirJanela("Internet Explorer");
  }, 3000);
}

function abrirJanela(titulo) {
  const janela = document.createElement("div");
  janela.className = "janela";

  let conteudo = `<div class="janela-corpo"><p>Carregando...</p></div>`;

  if (titulo === "Instalador do Windows 7") {
    conteudo = `
      <div class="janela-corpo">
        <h3 style="color:#003399;">Instalador do Windows 7</h3>
        <p>üß† Verificando compatibilidade reversa...</p>
        <p>üîß Instalando arquivos essenciais do caos...</p>
        <progress max="100" value="30"></progress>
      </div>
    `;
  }

  if (titulo === "Internet Explorer") {
    conteudo = `
      <div class="janela-corpo">
        <h3 style="color:#990000;">Internet Explorer</h3>
        <p><strong>Bem-vindo ao WebXingOS Navegador!</strong></p>
        <ul>
          <li>üì¢ 9 an√∫ncios abertos em segundo plano</li>
          <li>ü¶† 3 v√≠rus detectados que se acham √∫teis</li>
          <li>üêµ BonziBuddy est√° tentando assumir a aba</li>
        </ul>
        <button onclick="abrirJanela('Erro Cr√≠tico')">üí• Corrigir</button>
        <button onclick="abrirJanela('Mais An√∫ncios')">üì£ Quero mais an√∫ncios!</button>
      </div>
    `;
  }

  if (titulo === "Erro Cr√≠tico") {
    conteudo = `
      <div class="janela-corpo">
        <p style="color:red;"><strong>‚ùå N√£o foi poss√≠vel corrigir os erros.</strong></p>
        <p>O instalador se arrependeu de existir.</p>
      </div>
    `;
  }

  if (titulo === "Mais An√∫ncios") {
    conteudo = `
      <div class="janela-corpo">
        <p><strong>üõçÔ∏è Promo√ß√£o reversa: Compre um v√≠rus, leve dois!</strong></p>
        <img src="ads.gif" width="100%" />
      </div>
    `;
  }

  janela.innerHTML = `
    <div class="janela-topo">
      <span>${titulo}</span>
      <button onclick="this.closest('.janela').remove()">‚ùå</button>
    </div>
    ${conteudo}
  `;

  document.getElementById("janelas").appendChild(janela);

  janela.style.top = Math.random() * 250 + "px";
  janela.style.left = Math.random() * 400 + "px";

  const topo = janela.querySelector(".janela-topo");
  topo.onmousedown = function (e) {
    const offsetX = e.clientX - janela.offsetLeft;
    const offsetY = e.clientY - janela.offsetTop;
    document.onmousemove = function (e) {
      janela.style.left = e.clientX - offsetX + "px";
      janela.style.top = e.clientY - offsetY + "px";
    };
    document.onmouseup = function () {
      document.onmousemove = null;
      document.onmouseup = null;
    };
  };
}
if (titulo === "Configura√ß√µes") {
  conteudo = `
    <div class="janela-corpo">
      <h3>üß© Configura√ß√µes do WebXingOS XP</h3>
      <ul style="list-style:none; padding-left:0;">
        <li><button onclick="abrirJanela('Mouse')">üñ±Ô∏è Configurar Mouse</button></li>
        <li><button onclick="abrirJanela('Visual')">üé® Apar√™ncia</button></li>
        <li><button onclick="abrirJanela('Windows Update')">üîÑ Windows Update</button></li>
        <li><button onclick="abrirJanela('Antiv√≠rus')">üõ°Ô∏è Antiv√≠rus Padr√£o</button></li>
      </ul>
    </div>
  `;
}

if (titulo === "Mouse") {
  conteudo = `
    <div class="janela-corpo">
      <h3>üñ±Ô∏è Configura√ß√µes do Mouse</h3>
      <label>Velocidade:</label>
      <input type="range" min="1" max="10" value="5">
      <p>Dica reversa: quanto mais r√°pido, menos controle.</p>
    </div>
  `;
}

if (titulo === "Visual") {
  conteudo = `
    <div class="janela-corpo">
      <h3>üé® Apar√™ncia</h3>
      <select>
        <option>XP Cl√°ssico</option>
        <option>Vista Travado</option>
        <option>Reverso Moderno</option>
      </select>
      <p>Voc√™ escolhe, ele ignora.</p>
    </div>
  `;
}

if (titulo === "Windows Update") {
  conteudo = `
    <div class="janela-corpo">
      <h3>üîÑ Windows Update</h3>
      <p>Verificando atualiza√ß√µes dispon√≠veis...<br>Encontrado: "Pacote de Lentid√£o 7.2"</p>
      <button onclick="alert('Atualiza√ß√£o falhou por motivo desconhecido.')">Instalar</button>
    </div>
  `;
}

if (titulo === "Antiv√≠rus") {
  conteudo = `
    <div class="janela-corpo">
      <h3>üõ°Ô∏è Antiv√≠rus Padr√£o</h3>
      <p>Status: Confuso</p>
      <button onclick="alert('Antiv√≠rus ativado. BonziBuddy em quarentena... talvez.')">Executar verifica√ß√£o</button>
    </div>
  `;
}
